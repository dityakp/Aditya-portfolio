name: Production Validation Checks

on:
  push:
    branches:
      - Production

jobs:
  validate-files:
    runs-on: ubuntu-latest
    name: Validate Portfolio Files
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          submodules: recursive
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
      
      - name: Install validation tools
        run: |
          npm install -g htmlhint stylelint eslint
          
      - name: Validate HTML files
        run: |
          echo "üîç Validating HTML files..."
          cd Aditya-portfolio
          htmlhint "**/*.html" || echo "‚ö†Ô∏è HTML validation warnings found"
          
      - name: Validate CSS files
        run: |
          echo "üé® Validating CSS files..."
          cd Aditya-portfolio
          npx stylelint "**/*.css" --config-basedir . || echo "‚ö†Ô∏è CSS validation warnings found"
        continue-on-error: true
          
      - name: Validate JavaScript files
        run: |
          echo "‚ö° Validating JavaScript files..."
          cd Aditya-portfolio
          npx eslint "**/*.js" --no-eslintrc --env browser,es2021 || echo "‚ö†Ô∏è JS validation warnings found"
        continue-on-error: true
      
      - name: Check for broken links (HTML)
        run: |
          echo "üîó Checking for broken internal links..."
          cd Aditya-portfolio
          if [ -f "index.html" ]; then
            grep -oP 'href="[^"]*"' index.html | grep -v "http" | sed 's/href="//;s/"//' || echo "No internal links found"
          fi
          
      - name: Check file structure
        run: |
          echo "üìÅ Checking file structure..."
          cd Aditya-portfolio
          echo "‚úÖ Required files:"
          [ -f "index.html" ] && echo "  ‚úì index.html" || echo "  ‚úó index.html MISSING"
          [ -d "css" ] && echo "  ‚úì css/ directory" || echo "  ‚úó css/ directory MISSING"
          [ -d "js" ] && echo "  ‚úì js/ directory" || echo "  ‚úó js/ directory MISSING"
          [ -d "assets" ] && echo "  ‚úì assets/ directory" || echo "  ‚ö† assets/ directory not found"
          
      - name: List all files
        run: |
          echo "üìã Portfolio file structure:"
          cd Aditya-portfolio
          find . -type f -not -path '*/\.*' | sort
          
      - name: Production Check Summary
        run: |
          echo "‚úÖ Production validation completed!"
          echo "üìä All checks have been executed."
          echo "Review the logs above for any warnings or errors."
